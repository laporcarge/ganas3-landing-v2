<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ganamos.co - ¬°Gana y Disfruta!</title>

  <!-- Meta Pixel -->
  <script>
    !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
    n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window, document,'script','https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '747470498138166');
    fbq('track', 'PageView');
  </script>
  <noscript>
    <img height="1" width="1" style="display:none" alt=""
         src="https://www.facebook.com/tr?id=747470498138166&ev=PageView&noscript=1"/>
  </noscript>

  <style>
    body{background:#111;color:#fff;display:flex;align-items:center;justify-content:center;height:100vh;text-align:center;font-family:'Poppins',sans-serif}
    .hero{width:100%;height:100vh;display:flex;align-items:center;justify-content:center;flex-direction:column;padding:20px;
      background:linear-gradient(rgba(0,0,0,.7),rgba(0,0,0,.7)),url('https://static.vecteezy.com/system/resources/previews/003/810/467/non_2x/casino-advertising-neon-banner-design-with-playing-cards-and-casino-chips-on-purple-background-vector.jpg') center/cover no-repeat}
    .animated-title{font-size:2.2rem;font-weight:700;text-shadow:2px 2px 5px rgba(0,0,0,.8)}
    .highlight{font-size:1.05rem;margin:10px 0;text-shadow:2px 2px 5px rgba(0,0,0,.8)}
    .boton-wsp{text-decoration:none;display:inline-block;background-color:#25d366;color:#fff;padding:14px 26px;border-radius:10px;font-weight:700;font-size:18px;margin-top:20px;box-shadow:0 4px 15px rgba(0,0,0,.5);transition:transform .2s,background-color .3s}
    .boton-wsp:hover{background-color:#1da851;transform:scale(1.03)}
  </style>
</head>

<body>
  <div class="hero">
    <h1 class="animated-title">üî• ¬°REG√çSTRATE Y COMIENZA A GANAR! üî•</h1>
    <p class="highlight">Carga m√≠nima: <strong>$3000</strong></p>
    <p class="highlight">üé∞ +2000 tragamonedas | ‚ú® Retiros sin l√≠mite | üç± Bonos exclusivos</p>

    <!-- NO se toca est√©tica ni atributos -->
    <a id="whatsapp-link" class="boton-wsp" target="_blank" rel="noopener noreferrer"
       href="https://wa.me/5493518761399?text=Hola%2C%20quiero%20crear%20un%20usuario!%20Mi%20nombre%20es">
      üëâ Consult√° tu beneficio ahora por WhatsApp
    </a>
  </div>

  <!-- Agregamos Contact (est√°ndar) + mantenemos ButtonClick (custom) y mandamos CAPI con el mismo event_id -->
  <script>
    // Helpers para _fbp/_fbc (opcional, pero suma para matching)
    function getCookie(name) {
      return ('; ' + document.cookie).split('; ' + name + '=').pop()?.split(';')[0];
    }
    function getParam(name) {
      return new URLSearchParams(location.search).get(name);
    }

    // eventID para deduplicaci√≥n
    function genEventId() {
      return 'contact-' + Date.now() + '-' + Math.random().toString(36).slice(2, 8);
    }

    document.addEventListener('DOMContentLoaded', function () {
      var btn = document.getElementById('whatsapp-link');
      if (!btn) return;

      btn.addEventListener('click', async function () {
        if (typeof fbq !== 'undefined') {
          var eventId = genEventId();
          window.lastContactEventId = eventId; // por si quer√©s inspeccionarlo

          // 1) Pixel: mantenemos el custom para la campa√±a vieja
          fbq('trackCustom', 'ButtonClick', { button: 'whatsapp' }, { eventID: eventId });

          // 2) Pixel: sumamos Contact (evento est√°ndar) para la campa√±a nueva
          fbq('track', 'Contact', { channel: 'whatsapp' }, { eventID: eventId });

          // 3) CAPI: enviamos el mismo Contact con el MISMO event_id (deduplicaci√≥n)
          try {
            await fetch('/api/meta-capi', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              keepalive: true, // ayuda si el usuario salta de p√°gina r√°pido
              body: JSON.stringify({
                event_name: 'Contact',
                event_id: eventId,
                event_source_url: location.href,
                custom_data: { channel: 'whatsapp' },
                fbp: getCookie('_fbp'),
                // _fbc desde cookie o armado con fbclid de la URL
                fbc: getCookie('_fbc') || (getParam('fbclid') ? `fb.1.${Date.now()}.${getParam('fbclid')}` : undefined)
                // test_event_code: 'TU_CODIGO_DE_TEST' // descoment√° para "Probar eventos"
              })
            });
          } catch (e) {
            console.warn('CAPI fetch error:', e);
          }
        }
      });
    });
  </script>
</body>
</html>
